/// <reference types="./otpauth.d.ts" />
const ye=r=>{const e=new ArrayBuffer(8),t=new Uint8Array(e);let n=r;for(let i=7;i>=0&&n!==0;i--)t[i]=n&255,n-=t[i],n/=256;return e},ct=void 0,lt=void 0,ft=void 0;var q=Object.freeze({__proto__:null,createHmac:void 0,randomBytes:void 0,timingSafeEqual:void 0});const J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q="ARRAYBUFFER not supported by this environment",W="UINT8ARRAY not supported by this environment";function _(r,e,t,n){let i,s,u;const c=e||[0],h=(t=t||0)>>>3,l=n===-1?3:0;for(i=0;i<r.length;i+=1)u=i+h,s=u>>>2,c.length<=s&&c.push(0),c[s]|=r[i]<<8*(l+n*(u%4));return{value:c,binLen:8*r.length+t}}function F(r,e,t){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(r){case"HEX":return function(n,i,s){return function(u,c,h,l){let d,a,f,g;if(u.length%2!=0)throw new Error("String of HEX type must be in byte increments");const p=c||[0],m=(h=h||0)>>>3,A=l===-1?3:0;for(d=0;d<u.length;d+=2){if(a=parseInt(u.substr(d,2),16),isNaN(a))throw new Error("String of HEX type contains invalid characters");for(g=(d>>>1)+m,f=g>>>2;p.length<=f;)p.push(0);p[f]|=a<<8*(A+l*(g%4))}return{value:p,binLen:4*u.length+h}}(n,i,s,t)};case"TEXT":return function(n,i,s){return function(u,c,h,l,d){let a,f,g,p,m,A,y,b,N=0;const v=h||[0],S=(l=l||0)>>>3;if(c==="UTF8")for(y=d===-1?3:0,g=0;g<u.length;g+=1)for(a=u.charCodeAt(g),f=[],128>a?f.push(a):2048>a?(f.push(192|a>>>6),f.push(128|63&a)):55296>a||57344<=a?f.push(224|a>>>12,128|a>>>6&63,128|63&a):(g+=1,a=65536+((1023&a)<<10|1023&u.charCodeAt(g)),f.push(240|a>>>18,128|a>>>12&63,128|a>>>6&63,128|63&a)),p=0;p<f.length;p+=1){for(A=N+S,m=A>>>2;v.length<=m;)v.push(0);v[m]|=f[p]<<8*(y+d*(A%4)),N+=1}else for(y=d===-1?2:0,b=c==="UTF16LE"&&d!==1||c!=="UTF16LE"&&d===1,g=0;g<u.length;g+=1){for(a=u.charCodeAt(g),b===!0&&(p=255&a,a=p<<8|a>>>8),A=N+S,m=A>>>2;v.length<=m;)v.push(0);v[m]|=a<<8*(y+d*(A%4)),N+=2}return{value:v,binLen:8*N+l}}(n,e,i,s,t)};case"B64":return function(n,i,s){return function(u,c,h,l){let d,a,f,g,p,m,A,y=0;const b=c||[0],N=(h=h||0)>>>3,v=l===-1?3:0,S=u.indexOf("=");if(u.search(/^[a-zA-Z0-9=+/]+$/)===-1)throw new Error("Invalid character in base-64 string");if(u=u.replace(/=/g,""),S!==-1&&S<u.length)throw new Error("Invalid '=' found in base-64 string");for(a=0;a<u.length;a+=4){for(p=u.substr(a,4),g=0,f=0;f<p.length;f+=1)d=J.indexOf(p.charAt(f)),g|=d<<18-6*f;for(f=0;f<p.length-1;f+=1){for(A=y+N,m=A>>>2;b.length<=m;)b.push(0);b[m]|=(g>>>16-8*f&255)<<8*(v+l*(A%4)),y+=1}}return{value:b,binLen:8*y+h}}(n,i,s,t)};case"BYTES":return function(n,i,s){return function(u,c,h,l){let d,a,f,g;const p=c||[0],m=(h=h||0)>>>3,A=l===-1?3:0;for(a=0;a<u.length;a+=1)d=u.charCodeAt(a),g=a+m,f=g>>>2,p.length<=f&&p.push(0),p[f]|=d<<8*(A+l*(g%4));return{value:p,binLen:8*u.length+h}}(n,i,s,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(n){throw new Error(Q)}return function(n,i,s){return function(u,c,h,l){return _(new Uint8Array(u),c,h,l)}(n,i,s,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(n){throw new Error(W)}return function(n,i,s){return _(n,i,s,t)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function ee(r,e,t,n){switch(r){case"HEX":return function(i){return function(s,u,c,h){const l="0123456789abcdef";let d,a,f="";const g=u/8,p=c===-1?3:0;for(d=0;d<g;d+=1)a=s[d>>>2]>>>8*(p+c*(d%4)),f+=l.charAt(a>>>4&15)+l.charAt(15&a);return h.outputUpper?f.toUpperCase():f}(i,e,t,n)};case"B64":return function(i){return function(s,u,c,h){let l,d,a,f,g,p="";const m=u/8,A=c===-1?3:0;for(l=0;l<m;l+=3)for(f=l+1<m?s[l+1>>>2]:0,g=l+2<m?s[l+2>>>2]:0,a=(s[l>>>2]>>>8*(A+c*(l%4))&255)<<16|(f>>>8*(A+c*((l+1)%4))&255)<<8|g>>>8*(A+c*((l+2)%4))&255,d=0;d<4;d+=1)p+=8*l+6*d<=u?J.charAt(a>>>6*(3-d)&63):h.b64Pad;return p}(i,e,t,n)};case"BYTES":return function(i){return function(s,u,c){let h,l,d="";const a=u/8,f=c===-1?3:0;for(h=0;h<a;h+=1)l=s[h>>>2]>>>8*(f+c*(h%4))&255,d+=String.fromCharCode(l);return d}(i,e,t)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(i){throw new Error(Q)}return function(i){return function(s,u,c){let h;const l=u/8,d=new ArrayBuffer(l),a=new Uint8Array(d),f=c===-1?3:0;for(h=0;h<l;h+=1)a[h]=s[h>>>2]>>>8*(f+c*(h%4))&255;return d}(i,e,t)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(i){throw new Error(W)}return function(i){return function(s,u,c){let h;const l=u/8,d=c===-1?3:0,a=new Uint8Array(l);for(h=0;h<l;h+=1)a[h]=s[h>>>2]>>>8*(d+c*(h%4))&255;return a}(i,e,t)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const k=4294967296,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],$=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],C=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],P="Chosen SHA variant is not supported",te="Cannot set numRounds with MAC";function z(r,e){let t,n;const i=r.binLen>>>3,s=e.binLen>>>3,u=i<<3,c=4-i<<3;if(i%4!=0){for(t=0;t<s;t+=4)n=i+t>>>2,r.value[n]|=e.value[t>>>2]<<u,r.value.push(0),r.value[n+1]|=e.value[t>>>2]>>>c;return(r.value.length<<2)-4>=s+i&&r.value.pop(),{value:r.value,binLen:r.binLen+e.binLen}}return{value:r.value.concat(e.value),binLen:r.binLen+e.binLen}}function ne(r){const e={outputUpper:!1,b64Pad:"=",outputLen:-1},t=r||{},n="Output length must be a multiple of 8";if(e.outputUpper=t.outputUpper||!1,t.b64Pad&&(e.b64Pad=t.b64Pad),t.outputLen){if(t.outputLen%8!=0)throw new Error(n);e.outputLen=t.outputLen}else if(t.shakeLen){if(t.shakeLen%8!=0)throw new Error(n);e.outputLen=t.shakeLen}if(typeof e.outputUpper!="boolean")throw new Error("Invalid outputUpper formatting option");if(typeof e.b64Pad!="string")throw new Error("Invalid b64Pad formatting option");return e}function K(r,e,t,n){const i=r+" must include a value and format";if(!e){if(!n)throw new Error(i);return n}if(e.value===void 0||!e.format)throw new Error(i);return F(e.format,e.encoding||"UTF8",t)(e.value)}class j{constructor(e,t,n){const i=n||{};if(this.t=t,this.i=i.encoding||"UTF8",this.numRounds=i.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let t,n=0;const i=this.m>>>5,s=this.C(e,this.h,this.u),u=s.binLen,c=s.value,h=u>>>5;for(t=0;t<h;t+=i)n+this.m<=u&&(this.U=this.v(c.slice(t,t+i),this.U),n+=this.m);return this.A+=n,this.h=c.slice(n>>>5),this.u=u%this.m,this.l=!0,this}getHash(e,t){let n,i,s=this.R;const u=ne(t);if(this.K){if(u.outputLen===-1)throw new Error("Output length must be specified in options");s=u.outputLen}const c=ee(e,s,this.T,u);if(this.H&&this.g)return c(this.g(u));for(i=this.F(this.h.slice(),this.u,this.A,this.L(this.U),s),n=1;n<this.numRounds;n+=1)this.K&&s%32!=0&&(i[i.length-1]&=16777215>>>24-s%32),i=this.F(i,s,0,this.B(this.o),s);return c(i)}setHMACKey(e,t,n){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const i=F(t,(n||{}).encoding||"UTF8",this.T);this.k(i(e))}k(e){const t=this.m>>>3,n=t/4-1;let i;if(this.numRounds!==1)throw new Error(te);if(this.H)throw new Error("MAC key already set");for(t<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=n;)e.value.push(0);for(i=0;i<=n;i+=1)this.S[i]=909522486^e.value[i],this.p[i]=1549556828^e.value[i];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,t){const n=ne(t);return ee(e,this.R,this.T,n)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const t=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(t,this.R,this.m,e,this.R),e}}function M(r,e){return r<<e|r>>>32-e}function L(r,e){return r>>>e|r<<32-e}function re(r,e){return r>>>e}function ie(r,e,t){return r^e^t}function se(r,e,t){return r&e^~r&t}function oe(r,e,t){return r&e^r&t^e&t}function ve(r){return L(r,2)^L(r,13)^L(r,22)}function I(r,e){const t=(65535&r)+(65535&e);return(65535&(r>>>16)+(e>>>16)+(t>>>16))<<16|65535&t}function He(r,e,t,n){const i=(65535&r)+(65535&e)+(65535&t)+(65535&n);return(65535&(r>>>16)+(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16))<<16|65535&i}function O(r,e,t,n,i){const s=(65535&r)+(65535&e)+(65535&t)+(65535&n)+(65535&i);return(65535&(r>>>16)+(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16)+(s>>>16))<<16|65535&s}function Ee(r){return L(r,7)^L(r,18)^re(r,3)}function Ne(r){return L(r,6)^L(r,11)^L(r,25)}function Se(r){return[1732584193,4023233417,2562383102,271733878,3285377520]}function ue(r,e){let t,n,i,s,u,c,h;const l=[];for(t=e[0],n=e[1],i=e[2],s=e[3],u=e[4],h=0;h<80;h+=1)l[h]=h<16?r[h]:M(l[h-3]^l[h-8]^l[h-14]^l[h-16],1),c=h<20?O(M(t,5),se(n,i,s),u,1518500249,l[h]):h<40?O(M(t,5),ie(n,i,s),u,1859775393,l[h]):h<60?O(M(t,5),oe(n,i,s),u,2400959708,l[h]):O(M(t,5),ie(n,i,s),u,3395469782,l[h]),u=s,s=i,i=M(n,30),n=t,t=c;return e[0]=I(t,e[0]),e[1]=I(n,e[1]),e[2]=I(i,e[2]),e[3]=I(s,e[3]),e[4]=I(u,e[4]),e}function Ue(r,e,t,n){let i;const s=15+(e+65>>>9<<4),u=e+t;for(;r.length<=s;)r.push(0);for(r[e>>>5]|=128<<24-e%32,r[s]=4294967295&u,r[s-1]=u/k|0,i=0;i<r.length;i+=16)n=ue(r.slice(i,i+16),n);return n}let Le=class extends j{constructor(r,e,t){if(r!=="SHA-1")throw new Error(P);super(r,e,t);const n=t||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=F(this.t,this.i,this.T),this.v=ue,this.L=function(i){return i.slice()},this.B=Se,this.F=Ue,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,n.hmacKey&&this.k(K("hmacKey",n.hmacKey,this.T))}};function he(r){let e;return e=r=="SHA-224"?$.slice():C.slice(),e}function ae(r,e){let t,n,i,s,u,c,h,l,d,a,f;const g=[];for(t=e[0],n=e[1],i=e[2],s=e[3],u=e[4],c=e[5],h=e[6],l=e[7],f=0;f<64;f+=1)g[f]=f<16?r[f]:He(L(p=g[f-2],17)^L(p,19)^re(p,10),g[f-7],Ee(g[f-15]),g[f-16]),d=O(l,Ne(u),se(u,c,h),w[f],g[f]),a=I(ve(t),oe(t,n,i)),l=h,h=c,c=u,u=I(s,d),s=i,i=n,n=t,t=I(d,a);var p;return e[0]=I(t,e[0]),e[1]=I(n,e[1]),e[2]=I(i,e[2]),e[3]=I(s,e[3]),e[4]=I(u,e[4]),e[5]=I(c,e[5]),e[6]=I(h,e[6]),e[7]=I(l,e[7]),e}let Re=class extends j{constructor(r,e,t){if(r!=="SHA-224"&&r!=="SHA-256")throw new Error(P);super(r,e,t);const n=t||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=F(this.t,this.i,this.T),this.v=ae,this.L=function(i){return i.slice()},this.B=he,this.F=function(i,s,u,c){return function(h,l,d,a,f){let g,p;const m=15+(l+65>>>9<<4),A=l+d;for(;h.length<=m;)h.push(0);for(h[l>>>5]|=128<<24-l%32,h[m]=4294967295&A,h[m-1]=A/k|0,g=0;g<h.length;g+=16)a=ae(h.slice(g,g+16),a);return p=f==="SHA-224"?[a[0],a[1],a[2],a[3],a[4],a[5],a[6]]:a,p}(i,s,u,c,r)},this.U=he(r),this.m=512,this.R=r==="SHA-224"?224:256,this.K=!1,n.hmacKey&&this.k(K("hmacKey",n.hmacKey,this.T))}};class o{constructor(e,t){this.N=e,this.I=t}}function ce(r,e){let t;return e>32?(t=64-e,new o(r.I<<e|r.N>>>t,r.N<<e|r.I>>>t)):e!==0?(t=32-e,new o(r.N<<e|r.I>>>t,r.I<<e|r.N>>>t)):r}function R(r,e){let t;return e<32?(t=32-e,new o(r.N>>>e|r.I<<t,r.I>>>e|r.N<<t)):(t=64-e,new o(r.I>>>e|r.N<<t,r.N>>>e|r.I<<t))}function le(r,e){return new o(r.N>>>e,r.I>>>e|r.N<<32-e)}function Te(r,e,t){return new o(r.N&e.N^r.N&t.N^e.N&t.N,r.I&e.I^r.I&t.I^e.I&t.I)}function $e(r){const e=R(r,28),t=R(r,34),n=R(r,39);return new o(e.N^t.N^n.N,e.I^t.I^n.I)}function U(r,e){let t,n;t=(65535&r.I)+(65535&e.I),n=(r.I>>>16)+(e.I>>>16)+(t>>>16);const i=(65535&n)<<16|65535&t;return t=(65535&r.N)+(65535&e.N)+(n>>>16),n=(r.N>>>16)+(e.N>>>16)+(t>>>16),new o((65535&n)<<16|65535&t,i)}function Ce(r,e,t,n){let i,s;i=(65535&r.I)+(65535&e.I)+(65535&t.I)+(65535&n.I),s=(r.I>>>16)+(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i>>>16);const u=(65535&s)<<16|65535&i;return i=(65535&r.N)+(65535&e.N)+(65535&t.N)+(65535&n.N)+(s>>>16),s=(r.N>>>16)+(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i>>>16),new o((65535&s)<<16|65535&i,u)}function Ke(r,e,t,n,i){let s,u;s=(65535&r.I)+(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&i.I),u=(r.I>>>16)+(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i.I>>>16)+(s>>>16);const c=(65535&u)<<16|65535&s;return s=(65535&r.N)+(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&i.N)+(u>>>16),u=(r.N>>>16)+(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i.N>>>16)+(s>>>16),new o((65535&u)<<16|65535&s,c)}function Y(r,e){return new o(r.N^e.N,r.I^e.I)}function Be(r){const e=R(r,19),t=R(r,61),n=le(r,6);return new o(e.N^t.N^n.N,e.I^t.I^n.I)}function Fe(r){const e=R(r,1),t=R(r,8),n=le(r,7);return new o(e.N^t.N^n.N,e.I^t.I^n.I)}function Me(r){const e=R(r,14),t=R(r,18),n=R(r,41);return new o(e.N^t.N^n.N,e.I^t.I^n.I)}const ke=[new o(w[0],3609767458),new o(w[1],602891725),new o(w[2],3964484399),new o(w[3],2173295548),new o(w[4],4081628472),new o(w[5],3053834265),new o(w[6],2937671579),new o(w[7],3664609560),new o(w[8],2734883394),new o(w[9],1164996542),new o(w[10],1323610764),new o(w[11],3590304994),new o(w[12],4068182383),new o(w[13],991336113),new o(w[14],633803317),new o(w[15],3479774868),new o(w[16],2666613458),new o(w[17],944711139),new o(w[18],2341262773),new o(w[19],2007800933),new o(w[20],1495990901),new o(w[21],1856431235),new o(w[22],3175218132),new o(w[23],2198950837),new o(w[24],3999719339),new o(w[25],766784016),new o(w[26],2566594879),new o(w[27],3203337956),new o(w[28],1034457026),new o(w[29],2466948901),new o(w[30],3758326383),new o(w[31],168717936),new o(w[32],1188179964),new o(w[33],1546045734),new o(w[34],1522805485),new o(w[35],2643833823),new o(w[36],2343527390),new o(w[37],1014477480),new o(w[38],1206759142),new o(w[39],344077627),new o(w[40],1290863460),new o(w[41],3158454273),new o(w[42],3505952657),new o(w[43],106217008),new o(w[44],3606008344),new o(w[45],1432725776),new o(w[46],1467031594),new o(w[47],851169720),new o(w[48],3100823752),new o(w[49],1363258195),new o(w[50],3750685593),new o(w[51],3785050280),new o(w[52],3318307427),new o(w[53],3812723403),new o(w[54],2003034995),new o(w[55],3602036899),new o(w[56],1575990012),new o(w[57],1125592928),new o(w[58],2716904306),new o(w[59],442776044),new o(w[60],593698344),new o(w[61],3733110249),new o(w[62],2999351573),new o(w[63],3815920427),new o(3391569614,3928383900),new o(3515267271,566280711),new o(3940187606,3454069534),new o(4118630271,4000239992),new o(116418474,1914138554),new o(174292421,2731055270),new o(289380356,3203993006),new o(460393269,320620315),new o(685471733,587496836),new o(852142971,1086792851),new o(1017036298,365543100),new o(1126000580,2618297676),new o(1288033470,3409855158),new o(1501505948,4234509866),new o(1607167915,987167468),new o(1816402316,1246189591)];function fe(r){return r==="SHA-384"?[new o(3418070365,$[0]),new o(1654270250,$[1]),new o(2438529370,$[2]),new o(355462360,$[3]),new o(1731405415,$[4]),new o(41048885895,$[5]),new o(3675008525,$[6]),new o(1203062813,$[7])]:[new o(C[0],4089235720),new o(C[1],2227873595),new o(C[2],4271175723),new o(C[3],1595750129),new o(C[4],2917565137),new o(C[5],725511199),new o(C[6],4215389547),new o(C[7],327033209)]}function we(r,e){let t,n,i,s,u,c,h,l,d,a,f,g;const p=[];for(t=e[0],n=e[1],i=e[2],s=e[3],u=e[4],c=e[5],h=e[6],l=e[7],f=0;f<80;f+=1)f<16?(g=2*f,p[f]=new o(r[g],r[g+1])):p[f]=Ce(Be(p[f-2]),p[f-7],Fe(p[f-15]),p[f-16]),d=Ke(l,Me(u),(A=c,y=h,new o((m=u).N&A.N^~m.N&y.N,m.I&A.I^~m.I&y.I)),ke[f],p[f]),a=U($e(t),Te(t,n,i)),l=h,h=c,c=u,u=U(s,d),s=i,i=n,n=t,t=U(d,a);var m,A,y;return e[0]=U(t,e[0]),e[1]=U(n,e[1]),e[2]=U(i,e[2]),e[3]=U(s,e[3]),e[4]=U(u,e[4]),e[5]=U(c,e[5]),e[6]=U(h,e[6]),e[7]=U(l,e[7]),e}let Pe=class extends j{constructor(r,e,t){if(r!=="SHA-384"&&r!=="SHA-512")throw new Error(P);super(r,e,t);const n=t||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=F(this.t,this.i,this.T),this.v=we,this.L=function(i){return i.slice()},this.B=fe,this.F=function(i,s,u,c){return function(h,l,d,a,f){let g,p;const m=31+(l+129>>>10<<5),A=l+d;for(;h.length<=m;)h.push(0);for(h[l>>>5]|=128<<24-l%32,h[m]=4294967295&A,h[m-1]=A/k|0,g=0;g<h.length;g+=32)a=we(h.slice(g,g+32),a);return p=f==="SHA-384"?[a[0].N,a[0].I,a[1].N,a[1].I,a[2].N,a[2].I,a[3].N,a[3].I,a[4].N,a[4].I,a[5].N,a[5].I]:[a[0].N,a[0].I,a[1].N,a[1].I,a[2].N,a[2].I,a[3].N,a[3].I,a[4].N,a[4].I,a[5].N,a[5].I,a[6].N,a[6].I,a[7].N,a[7].I],p}(i,s,u,c,r)},this.U=fe(r),this.m=1024,this.R=r==="SHA-384"?384:512,this.K=!1,n.hmacKey&&this.k(K("hmacKey",n.hmacKey,this.T))}};const Oe=[new o(0,1),new o(0,32898),new o(2147483648,32906),new o(2147483648,2147516416),new o(0,32907),new o(0,2147483649),new o(2147483648,2147516545),new o(2147483648,32777),new o(0,138),new o(0,136),new o(0,2147516425),new o(0,2147483658),new o(0,2147516555),new o(2147483648,139),new o(2147483648,32905),new o(2147483648,32771),new o(2147483648,32770),new o(2147483648,128),new o(0,32778),new o(2147483648,2147483658),new o(2147483648,2147516545),new o(2147483648,32896),new o(0,2147483649),new o(2147483648,2147516424)],Ye=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function G(r){let e;const t=[];for(e=0;e<5;e+=1)t[e]=[new o(0,0),new o(0,0),new o(0,0),new o(0,0),new o(0,0)];return t}function xe(r){let e;const t=[];for(e=0;e<5;e+=1)t[e]=r[e].slice();return t}function D(r,e){let t,n,i,s;const u=[],c=[];if(r!==null)for(n=0;n<r.length;n+=2)e[(n>>>1)%5][(n>>>1)/5|0]=Y(e[(n>>>1)%5][(n>>>1)/5|0],new o(r[n+1],r[n]));for(t=0;t<24;t+=1){for(s=G(),n=0;n<5;n+=1)u[n]=(h=e[n][0],l=e[n][1],d=e[n][2],a=e[n][3],f=e[n][4],new o(h.N^l.N^d.N^a.N^f.N,h.I^l.I^d.I^a.I^f.I));for(n=0;n<5;n+=1)c[n]=Y(u[(n+4)%5],ce(u[(n+1)%5],1));for(n=0;n<5;n+=1)for(i=0;i<5;i+=1)e[n][i]=Y(e[n][i],c[n]);for(n=0;n<5;n+=1)for(i=0;i<5;i+=1)s[i][(2*n+3*i)%5]=ce(e[n][i],Ye[n][i]);for(n=0;n<5;n+=1)for(i=0;i<5;i+=1)e[n][i]=Y(s[n][i],new o(~s[(n+1)%5][i].N&s[(n+2)%5][i].N,~s[(n+1)%5][i].I&s[(n+2)%5][i].I));e[0][0]=Y(e[0][0],Oe[t])}var h,l,d,a,f;return e}function de(r){let e,t,n=0;const i=[0,0],s=[4294967295&r,r/k&2097151];for(e=6;e>=0;e--)t=s[e>>2]>>>8*e&255,t===0&&n===0||(i[n+1>>2]|=t<<8*(n+1),n+=1);return n=n!==0?n:1,i[0]|=n,{value:n+1>4?i:[i[0]],binLen:8+8*n}}function Z(r){return z(de(r.binLen),r)}function ge(r,e){let t,n=de(e);n=z(n,r);const i=e>>>2,s=(i-n.value.length%i)%i;for(t=0;t<s;t++)n.value.push(0);return n.value}let Xe=class extends j{constructor(r,e,t){let n=6,i=0;super(r,e,t);const s=t||{};if(this.numRounds!==1){if(s.kmacKey||s.hmacKey)throw new Error(te);if(this.o==="CSHAKE128"||this.o==="CSHAKE256")throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=F(this.t,this.i,this.T),this.v=D,this.L=xe,this.B=G,this.U=G(),this.K=!1,r){case"SHA3-224":this.m=i=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=i=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=i=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=i=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":n=31,this.m=i=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":n=31,this.m=i=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":n=4,this.m=i=1344,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":n=4,this.m=i=1088,this.X(t),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=i=1344,n=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=i=1088,n=this.O(t),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(P)}this.F=function(u,c,h,l,d){return function(a,f,g,p,m,A,y){let b,N,v=0;const S=[],X=m>>>5,Ie=f>>>5;for(b=0;b<Ie&&f>=m;b+=X)p=D(a.slice(b,b+X),p),f-=m;for(a=a.slice(b),f%=m;a.length<X;)a.push(0);for(b=f>>>3,a[b>>2]^=A<<b%4*8,a[X-1]^=2147483648,p=D(a,p);32*S.length<y&&(N=p[v%5][v/5|0],S.push(N.I),!(32*S.length>=y));)S.push(N.N),v+=1,64*v%m==0&&(D(null,p),v=0);return S}(u,c,0,l,i,n,d)},s.hmacKey&&this.k(K("hmacKey",s.hmacKey,this.T))}O(r,e){const t=function(i){const s=i||{};return{funcName:K("funcName",s.funcName,1,{value:[],binLen:0}),customization:K("Customization",s.customization,1,{value:[],binLen:0})}}(r||{});e&&(t.funcName=e);const n=z(Z(t.funcName),Z(t.customization));if(t.customization.binLen!==0||t.funcName.binLen!==0){const i=ge(n,this.m>>>3);for(let s=0;s<i.length;s+=this.m>>>5)this.U=this.v(i.slice(s,s+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(r){const e=function(n){const i=n||{};return{kmacKey:K("kmacKey",i.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:K("Customization",i.customization,1,{value:[],binLen:0})}}(r||{});this.O(r,e.funcName);const t=ge(Z(e.kmacKey),this.m>>>3);for(let n=0;n<t.length;n+=this.m>>>5)this.U=this.v(t.slice(n,n+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(r){const e=z({value:this.h.slice(),binLen:this.u},function(t){let n,i,s=0;const u=[0,0],c=[4294967295&t,t/k&2097151];for(n=6;n>=0;n--)i=c[n>>2]>>>8*n&255,i===0&&s===0||(u[s>>2]|=i<<8*s,s+=1);return s=s!==0?s:1,u[s>>2]|=s<<8*s,{value:s+1>4?u:[u[0]],binLen:8+8*s}}(r.outputLen));return this.F(e.value,e.binLen,this.A,this.L(this.U),r.outputLen)}};class ze{constructor(e,t,n){if(e=="SHA-1")this.P=new Le(e,t,n);else if(e=="SHA-224"||e=="SHA-256")this.P=new Re(e,t,n);else if(e=="SHA-384"||e=="SHA-512")this.P=new Pe(e,t,n);else{if(e!="SHA3-224"&&e!="SHA3-256"&&e!="SHA3-384"&&e!="SHA3-512"&&e!="SHAKE128"&&e!="SHAKE256"&&e!="CSHAKE128"&&e!="CSHAKE256"&&e!="KMAC128"&&e!="KMAC256")throw new Error(P);this.P=new Xe(e,t,n)}}update(e){return this.P.update(e),this}getHash(e,t){return this.P.getHash(e,t)}setHMACKey(e,t,n){this.P.setHMACKey(e,t,n)}getHMAC(e,t){return this.P.getHMAC(e,t)}}const B=(()=>{if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"__GLOBALTHIS__",{get(){return this},configurable:!0});try{if(typeof __GLOBALTHIS__!="undefined")return __GLOBALTHIS__}finally{delete Object.prototype.__GLOBALTHIS__}if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global})();var je=(r,e,t)=>new Promise((n,i)=>{var s=h=>{try{c(t.next(h))}catch(l){i(l)}},u=h=>{try{c(t.throw(h))}catch(l){i(l)}},c=h=>h.done?n(h.value):Promise.resolve(h.value).then(s,u);c((t=t.apply(r,e)).next())});const De={SHA1:"SHA-1",SHA224:"SHA-224",SHA256:"SHA-256",SHA384:"SHA-384",SHA512:"SHA-512","SHA3-224":"SHA3-224","SHA3-256":"SHA3-256","SHA3-384":"SHA3-384","SHA3-512":"SHA3-512"},qe=(r,e,t)=>je(void 0,null,function*(){var n,i;q!=null;const s=De[r.toUpperCase()];if(typeof s=="undefined")throw new TypeError("Unknown hash function");if((i=(n=B)==null?void 0:n.crypto)!=null&&i.subtle){const u=B.crypto,c={name:"HMAC",hash:s},h=yield u.subtle.importKey("raw",e,c,!1,["sign"]);return yield u.subtle.sign(c,h,t)}else{const u=new ze(s,"ARRAYBUFFER");return u.setHMACKey(e,"ARRAYBUFFER"),u.update(t),u.getHMAC("ARRAYBUFFER")}}),V="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",Ge=r=>{let e=r.length;for(;r[e-1]==="=";)--e;const t=(e<r.length?r.substring(0,e):r).toUpperCase(),n=new ArrayBuffer(t.length*5/8|0),i=new Uint8Array(n);let s=0,u=0,c=0;for(let h=0;h<t.length;h++){const l=V.indexOf(t[h]);if(l===-1)throw new TypeError(`Invalid character found: ${t[h]}`);u=u<<5|l,s+=5,s>=8&&(s-=8,i[c++]=u>>>s)}return n},Ze=r=>{const e=new Uint8Array(r);let t=0,n=0,i="";for(let s=0;s<e.length;s++)for(n=n<<8|e[s],t+=8;t>=5;)i+=V[n>>>t-5&31],t-=5;return t>0&&(i+=V[n<<5-t&31]),i},Ve=r=>{const e=new ArrayBuffer(r.length/2),t=new Uint8Array(e);for(let n=0;n<r.length;n+=2)t[n/2]=parseInt(r.substring(n,n+2),16);return e},Je=r=>{const e=new Uint8Array(r);let t="";for(let n=0;n<e.length;n++){const i=e[n].toString(16);i.length===1&&(t+="0"),t+=i}return t.toUpperCase()},Qe=r=>{const e=new ArrayBuffer(r.length),t=new Uint8Array(e);for(let n=0;n<r.length;n++)t[n]=r.charCodeAt(n)&255;return e},We=r=>{const e=new Uint8Array(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},pe=B.TextEncoder?new B.TextEncoder("utf-8"):null,me=B.TextDecoder?new B.TextDecoder("utf-8"):null,_e=r=>{if(!pe)throw new Error("Encoding API not available");return pe.encode(r).buffer},et=r=>{if(!me)throw new Error("Encoding API not available");return me.decode(r)},tt=r=>{var e;if(q!=null,!((e=B.crypto)!=null&&e.getRandomValues))throw new Error("Cryptography API not available");return B.crypto.getRandomValues(new Uint8Array(r)).buffer};class T{constructor({buffer:e,size:t=20}={}){this.buffer=typeof e=="undefined"?tt(t):e}static fromLatin1(e){return new T({buffer:Qe(e)})}static fromUTF8(e){return new T({buffer:_e(e)})}static fromBase32(e){return new T({buffer:Ge(e)})}static fromHex(e){return new T({buffer:Ve(e)})}get latin1(){return Object.defineProperty(this,"latin1",{enumerable:!0,value:We(this.buffer)}),this.latin1}get utf8(){return Object.defineProperty(this,"utf8",{enumerable:!0,value:et(this.buffer)}),this.utf8}get base32(){return Object.defineProperty(this,"base32",{enumerable:!0,value:Ze(this.buffer)}),this.base32}get hex(){return Object.defineProperty(this,"hex",{enumerable:!0,value:Je(this.buffer)}),this.hex}}const nt=(r,e)=>{q!=null;{if(r.length!==e.length)throw new TypeError("Input strings must have the same length");let t=-1,n=0;for(;++t<r.length;)n|=r.charCodeAt(t)^e.charCodeAt(t);return n===0}};var rt=Math.pow,Ae=(r,e,t)=>new Promise((n,i)=>{var s=h=>{try{c(t.next(h))}catch(l){i(l)}},u=h=>{try{c(t.throw(h))}catch(l){i(l)}},c=h=>h.done?n(h.value):Promise.resolve(h.value).then(s,u);c((t=t.apply(r,e)).next())});let x=class H{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,counter:0,window:1}}constructor({issuer:e=H.defaults.issuer,label:t=H.defaults.label,issuerInLabel:n=H.defaults.issuerInLabel,secret:i=new T,algorithm:s=H.defaults.algorithm,digits:u=H.defaults.digits,counter:c=H.defaults.counter}={}){this.issuer=e,this.label=t,this.issuerInLabel=n,this.secret=typeof i=="string"?T.fromBase32(i):i,this.algorithm=s.toUpperCase(),this.digits=u,this.counter=c}static generate(e){return Ae(this,arguments,function*({secret:t,algorithm:n=H.defaults.algorithm,digits:i=H.defaults.digits,counter:s=H.defaults.counter}){const u=new Uint8Array(yield qe(n,t.buffer,ye(s))),c=u[u.byteLength-1]&15;return(((u[c]&127)<<24|(u[c+1]&255)<<16|(u[c+2]&255)<<8|u[c+3]&255)%rt(10,i)).toString().padStart(i,"0")})}generate({counter:e=this.counter++}={}){return H.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:e})}static validate(e){return Ae(this,arguments,function*({token:t,secret:n,algorithm:i,digits:s,counter:u=H.defaults.counter,window:c=H.defaults.window}){if(t.length!==s)return null;let h=null;for(let l=u-c;l<=u+c;++l){const d=yield H.generate({secret:n,algorithm:i,digits:s,counter:l});nt(t,d)&&(h=l-u)}return h})}validate({token:e,counter:t=this.counter,window:n}){return H.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:t,window:n})}toString(){const e=encodeURIComponent;return`otpauth://hotp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&counter=${e(this.counter)}`}};class E{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,period:30,window:1}}constructor({issuer:e=E.defaults.issuer,label:t=E.defaults.label,issuerInLabel:n=E.defaults.issuerInLabel,secret:i=new T,algorithm:s=E.defaults.algorithm,digits:u=E.defaults.digits,period:c=E.defaults.period}={}){this.issuer=e,this.label=t,this.issuerInLabel=n,this.secret=typeof i=="string"?T.fromBase32(i):i,this.algorithm=s.toUpperCase(),this.digits=u,this.period=c}static generate({secret:e,algorithm:t,digits:n,period:i=E.defaults.period,timestamp:s=Date.now()}){return x.generate({secret:e,algorithm:t,digits:n,counter:Math.floor(s/1e3/i)})}generate({timestamp:e=Date.now()}={}){return E.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:e})}static validate({token:e,secret:t,algorithm:n,digits:i,period:s=E.defaults.period,timestamp:u=Date.now(),window:c}){return x.validate({token:e,secret:t,algorithm:n,digits:i,counter:Math.floor(u/1e3/s),window:c})}validate({token:e,timestamp:t,window:n}){return E.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:t,window:n})}toString(){const e=encodeURIComponent;return`otpauth://totp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&period=${e(this.period)}`}}const it=/^otpauth:\/\/([ht]otp)\/(.+)\?([A-Z0-9.~_-]+=[^?&]*(?:&[A-Z0-9.~_-]+=[^?&]*)*)$/i,st=/^[2-7A-Z]+=*$/i,ot=/^SHA(?:1|224|256|384|512|3-224|3-256|3-384|3-512)$/i,ut=/^[+-]?\d+$/,be=/^\+?[1-9]\d*$/;class ht{static parse(e){let t;try{t=e.match(it)}catch(h){}if(!Array.isArray(t))throw new URIError("Invalid URI format");const n=t[1].toLowerCase(),i=t[2].split(/(?::|%3A) *(.+)/i,2).map(decodeURIComponent),s=t[3].split("&").reduce((h,l)=>{const d=l.split(/=(.*)/,2).map(decodeURIComponent),a=d[0].toLowerCase(),f=d[1],g=h;return g[a]=f,g},{});let u;const c={};if(n==="hotp")if(u=x,typeof s.counter!="undefined"&&ut.test(s.counter))c.counter=parseInt(s.counter,10);else throw new TypeError("Missing or invalid 'counter' parameter");else if(n==="totp"){if(u=E,typeof s.period!="undefined")if(be.test(s.period))c.period=parseInt(s.period,10);else throw new TypeError("Invalid 'period' parameter")}else throw new TypeError("Unknown OTP type");if(typeof s.issuer!="undefined"&&(c.issuer=s.issuer),i.length===2?(c.label=i[1],typeof c.issuer=="undefined"||c.issuer===""?c.issuer=i[0]:i[0]===""&&(c.issuerInLabel=!1)):(c.label=i[0],typeof c.issuer!="undefined"&&c.issuer!==""&&(c.issuerInLabel=!1)),typeof s.secret!="undefined"&&st.test(s.secret))c.secret=s.secret;else throw new TypeError("Missing or invalid 'secret' parameter");if(typeof s.algorithm!="undefined")if(ot.test(s.algorithm))c.algorithm=s.algorithm;else throw new TypeError("Invalid 'algorithm' parameter");if(typeof s.digits!="undefined")if(be.test(s.digits))c.digits=parseInt(s.digits,10);else throw new TypeError("Invalid 'digits' parameter");return new u(c)}static stringify(e){if(e instanceof x||e instanceof E)return e.toString();throw new TypeError("Invalid 'HOTP/TOTP' object")}}const at="9.2.2";export{x as HOTP,T as Secret,E as TOTP,ht as URI,at as version};
//# sourceMappingURL=otpauth.esm.min.js.map
